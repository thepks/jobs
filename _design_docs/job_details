{
   "_id": "_design/job_details",
   "_rev": "13-7bb3bb06283caac673c7dc470c83cf37",
   "language": "javascript",
   "views": {
       "owner": {
           "map": "function(doc) {\n  if (doc.owner && doc.Jobname) {\n    if (doc.Progname === \"RFKK_MASS_ACT_SINGLE_JOB\") {\n       var underposn = doc.Jobname.lastIndexOf(\"_\"); \n        var job = doc.Jobname.slice(0,underposn);\n\tvar short_job = job.slice(0,4)+\"_\"+job.slice(12); \n        emit([short_job, doc.owner], doc.Strtdate);\n    } else {\n  \temit([doc.Progname, doc.owner], doc.Strtdate);\n    }\n  }\n}",
           "reduce": "_count"
       }
   },
   "lists": {
       "byuser": "function(head,req) { var results = []; var row; var roles = req.userCtx.roles; var admi = false; var requester = req.userCtx.name; for (var v=0;v<roles.length;v++) { if(roles[v] === \"_admin\" || roles[v] === \"jobadmin\"){admi=true;}} while(row=getRow()) {var user = row.key[1]; if(admi||user === requester) {results.push(row); } } var res = {}; res.rows = results; send(JSON.stringify(res)); }"
   }
}